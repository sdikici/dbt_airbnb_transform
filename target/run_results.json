{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-08-25T18:46:43.347731Z", "invocation_id": "e5dea1f1-8198-46e0-8348-2757c7b5f0ea", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.756074Z", "completed_at": "2024-08-25T18:46:40.762803Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.766602Z", "completed_at": "2024-08-25T18:46:40.766602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016289472579956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtlearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.775854Z", "completed_at": "2024-08-25T18:46:40.782855Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.785379Z", "completed_at": "2024-08-25T18:46:40.785379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017044544219970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM AIRBNB.raw.raw_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.796367Z", "completed_at": "2024-08-25T18:46:40.812101Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.816633Z", "completed_at": "2024-08-25T18:46:40.816633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02679276466369629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__src_hosts as (\nwith raw_hosts as (\nselect * from AIRBNB.raw.raw_hosts\n)\n\nselect\nid as host_id,\nname as host_name,\nis_superhost,\ncreated_at,\nupdated_at\nfrom raw_hosts\n), src_hosts AS (SELECT * FROM __dbt__cte__src_hosts)\n\nSELECT\nhost_id,\nnvl(host_name,'Anonymous') as host_name,\nis_superhost,\ncreated_at,\nupdated_at\nFROM src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.827157Z", "completed_at": "2024-08-25T18:46:40.849210Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.853211Z", "completed_at": "2024-08-25T18:46:40.853211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03213620185852051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "\n\n\n\nWITH  __dbt__cte__src_listings as (\nwith raw_listings as (\nselect * from AIRBNB.raw.raw_listings\n)\n\nselect \nid as listing_id,\nname AS listing_name,\nlisting_url,\nroom_type,\nminimum_nights,\nhost_id,\nprice as price_str,\ncreated_at,\nupdated_at\nfrom\nraw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM __dbt__cte__src_listings\n)\nSELECT\n  listing_id,\n  listing_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  REPLACE(\n    price_str,\n    '$'\n  ) :: NUMBER(\n    10,\n    2\n  ) AS price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.864005Z", "completed_at": "2024-08-25T18:46:40.943312Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.946837Z", "completed_at": "2024-08-25T18:46:40.947833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09004592895507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "--we create an incremental materialization here for appends\n\n\nwith  __dbt__cte__src_reviews as (\nwith raw_reviews as (\nselect * from AIRBNB.raw.raw_reviews\n)\nselect\nlisting_id,\ndate as review_date,\nreviewer_name,\ncomments as review_text,\nsentiment as review_sentiment\nfrom raw_reviews\n), src_reviews as (SELECT * from __dbt__cte__src_reviews)\n\nSELECT \n  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))\n    AS review_id,\n  *  \nFROM src_reviews\nWHERE review_text is not null\n --we check the most recent reviews for appending new reviews to the tables\n    AND review_date > (SELECT max(review_date) from AIRBNB.DEV.fct_reviews)  --'this' word here refers to the same model fct_reviews\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.960394Z", "completed_at": "2024-08-25T18:46:40.967909Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:40.971911Z", "completed_at": "2024-08-25T18:46:40.971911Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01955246925354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "with\nl as (SELECT * FROM AIRBNB.DEV.dim_listings_cleansed),\nh as (SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed\n)\n\nSELECT\nl.listing_id,\nl.listing_name,\nl.room_type,\nl.minimum_nights,\nl.price,\nl.host_id,\nh.host_name,\nh.is_superhost as host_is_superhost,\nl.created_at,\ngreatest(l.updated_at,h.updated_at) as updated_at\nfrom L\nleft JOIN h on h.host_id = l.host_id", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:40.982433Z", "completed_at": "2024-08-25T18:46:41.018198Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:41.021201Z", "completed_at": "2024-08-25T18:46:41.021201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04376983642578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_listings_cleansed\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:41.029727Z", "completed_at": "2024-08-25T18:46:41.037247Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:41.041243Z", "completed_at": "2024-08-25T18:46:41.041243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016525745391845703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dim_listings_min_nights", "compiled": true, "compiled_code": "SELECT * FROM\nAIRBNB.DEV.dim_listings_cleansed\nwhere minimum_nights < 1\nlimit 10", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:41.049773Z", "completed_at": "2024-08-25T18:46:42.773423Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:42.775709Z", "completed_at": "2024-08-25T18:46:42.775709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0397658348083496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "--we are going to call macro here for this test\n\n\n    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE\n    LISTING_ID IS NULL OR\n    LISTING_NAME IS NULL OR\n    ROOM_TYPE IS NULL OR\n    MINIMUM_NIGHTS IS NULL OR\n    HOST_ID IS NULL OR\n    PRICE IS NULL OR\n    CREATED_AT IS NULL OR\n    UPDATED_AT IS NULL OR\n    \n    FALSE\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.093959Z", "completed_at": "2024-08-25T18:46:43.119375Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.123380Z", "completed_at": "2024-08-25T18:46:43.123380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03542613983154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.134692Z", "completed_at": "2024-08-25T18:46:43.151685Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.156060Z", "completed_at": "2024-08-25T18:46:43.156060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028498172760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.168060Z", "completed_at": "2024-08-25T18:46:43.182058Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.188060Z", "completed_at": "2024-08-25T18:46:43.188060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02825617790222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313", "compiled": true, "compiled_code": "\nSELECT\n    *\nFROM\n    AIRBNB.DEV.dim_listings_cleansed\nWHERE\n    minimum_nights < 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.202449Z", "completed_at": "2024-08-25T18:46:43.228911Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.239318Z", "completed_at": "2024-08-25T18:46:43.239318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04517006874084473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from AIRBNB.DEV.dim_listings_cleansed\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from AIRBNB.DEV.dim_hosts_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.251666Z", "completed_at": "2024-08-25T18:46:43.273879Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.277880Z", "completed_at": "2024-08-25T18:46:43.277880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03323960304260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.289889Z", "completed_at": "2024-08-25T18:46:43.302125Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.306549Z", "completed_at": "2024-08-25T18:46:43.306549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023777484893798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.mart_full_moon_reviews", "compiled": true, "compiled_code": "\n\nwith fct_reviews as (SELECT * FROM AIRBNB.DEV.fct_reviews),\nfull_moon_dates as (SELECT * FROM AIRBNB.DEV.seed_full_moon_dates)\n\nSELECT\nr.*,\nCASE \n    WHEN fm.full_moon_date is NULL THEN 'not full moon' \n    ELSE  'full moon'\nEND as is_full_moon\nFROM\nfct_reviews r \nLEFT JOIN full_moon_dates fm \non (to_date(r.review_date) = DATEADD(day,1,fm.full_moon_date) )", "relation_name": "AIRBNB.DEV.mart_full_moon_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-25T18:46:43.322090Z", "completed_at": "2024-08-25T18:46:43.332094Z"}, {"name": "execute", "started_at": "2024-08-25T18:46:43.336091Z", "completed_at": "2024-08-25T18:46:43.336091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024999380111694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.consistent_created_at", "compiled": true, "compiled_code": "SELECT * FROM\nAIRBNB.DEV.fct_reviews as fct\nJOIN AIRBNB.DEV.dim_listings_cleansed as cl \nON fct.LISTING_ID = cl.LISTING_ID\nWHERE fct.REVIEW_DATE < cl.created_at\nLIMIT 10", "relation_name": null}], "elapsed_time": 4.7482500076293945, "args": {"exclude": [], "cache_selected_only": false, "introspect": true, "profiles_dir": "C:\\Users\\serca\\.dbt", "indirect_selection": "eager", "favor_state": false, "print": true, "log_file_max_bytes": 10485760, "log_path": "C:\\Users\\serca\\OneDrive\\Masa\u00fcst\u00fc\\UDEMY_Computer_Science\\DBT_Bootcamp\\dbtlearn\\logs", "use_colors_file": true, "which": "generate", "defer": false, "static": false, "invocation_command": "dbt docs generate", "printer_width": 80, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "log_format": "default", "version_check": true, "macro_debugging": false, "select": [], "project_dir": "C:\\Users\\serca\\OneDrive\\Masa\u00fcst\u00fc\\UDEMY_Computer_Science\\DBT_Bootcamp\\dbtlearn", "partial_parse": true, "partial_parse_file_diff": true, "show_resource_report": false, "log_level": "info", "strict_mode": false, "enable_legacy_logger": false, "write_json": true, "empty_catalog": false, "vars": {}, "send_anonymous_usage_stats": true, "static_parser": true, "use_colors": true, "quiet": false, "log_format_file": "debug", "compile": true, "require_explicit_package_overrides_for_builtin_materializations": false}}